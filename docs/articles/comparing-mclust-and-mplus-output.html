<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing Mplus and mclust output • tidyLPA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tidyLPA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Comparing Mplus and mclust output</h1>
                        <h4 class="author">Joshua Rosenberg</h4>
            
            <h4 class="date">2018-01-01</h4>
          </div>

    
    
<div class="contents">
<p>This vignette compares mclust and Mplus output, for the purpose of benchmarking the use of mclust, an open-source tool, to Mplus. Note that for the <code><a href="../reference/create_profiles_mplus.html">create_profiles_mplus()</a></code> function to work, you must have Mplus installed (and purchased).</p>
<pre><code>#&gt; Loading tidyLPA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyLPA)</code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code><a href="../reference/create_profiles_lpa.html">create_profiles_lpa()</a></code> uses the mclust R package, while <code><a href="../reference/create_profiles_mplus.html">create_profiles_mplus()</a></code> generates Mplus model syntax which is then run with Mplus.</p>
<p>When <code><a href="../reference/create_profiles_mplus.html">create_profiles_mplus()</a></code> is used, a number of files (<code>.dat</code> for the data, <code>.inp</code> for the model syntax, and <code>.out</code> for the model output) will be generated in your working directory. In future versions, these will be generated into a temporary directory by default). For example, when the following line of code is run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span></code></pre></div>
<p>The <code>t.inp</code> file is saved in your working directory with the following contents. Note that this code is likely different because it is generated programmatically and uses no defaults (it is likely less efficient than code that you would write by hand).</p>
<pre><code>TITLE: test
DATA: File is d.dat;
VARIABLE:
Names are Sepal_Length Sepal_Width Petal_Length Petal_Width;
Classes = c(2);
MODEL:
%overall%
[Sepal_Length Sepal_Width Petal_Length Petal_Width];
Sepal_Length Sepal_Width Petal_Length Petal_Width;
Sepal_Length WITH Sepal_Width@0;
Sepal_Length WITH Petal_Length@0;
Sepal_Length WITH Petal_Width@0;
Sepal_Width WITH Petal_Length@0;
Sepal_Width WITH Petal_Width@0;
Petal_Length WITH Petal_Width@0;
%c#1%
[Sepal_Length Sepal_Width Petal_Length Petal_Width];
Sepal_Length Sepal_Width Petal_Length Petal_Width(1-4);
Sepal_Length WITH Sepal_Width@0;
Sepal_Length WITH Petal_Length@0;
Sepal_Length WITH Petal_Width@0;
Sepal_Width WITH Petal_Length@0;
Sepal_Width WITH Petal_Width@0;
Petal_Length WITH Petal_Width@0;
%c#2%
[Sepal_Length Sepal_Width Petal_Length Petal_Width];
Sepal_Length Sepal_Width Petal_Length Petal_Width(1-4);
Sepal_Length WITH Sepal_Width@0;
Sepal_Length WITH Petal_Length@0;
Sepal_Length WITH Petal_Width@0;
Sepal_Width WITH Petal_Length@0;
Sepal_Width WITH Petal_Width@0;
Petal_Length WITH Petal_Width@0;
ANALYSIS: Type is mixture;
OUTPUT: TECH1 TECH11;</code></pre>
<p>We can see how this syntax changes if we change the function’s arguments by removing a variable, increasing the number of profiles, and changing the model that is specified:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, 
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span></code></pre></div>
<pre><code>TITLE: test
DATA: File is d.dat;
VARIABLE:
Names are Sepal_Length Sepal_Width Petal_Length;
Classes = c(3);
MODEL:
%overall%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length;
Sepal_Length WITH Sepal_Width;
Sepal_Length WITH Petal_Length;
Sepal_Width WITH Petal_Length;
%c#1%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length(1-3);
Sepal_Length WITH Sepal_Width(4);
Sepal_Length WITH Petal_Length(5);
Sepal_Width WITH Petal_Length(6);
%c#2%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length(1-3);
Sepal_Length WITH Sepal_Width(4);
Sepal_Length WITH Petal_Length(5);
Sepal_Width WITH Petal_Length(6);
%c#3%
[Sepal_Length Sepal_Width Petal_Length];
Sepal_Length Sepal_Width Petal_Length(1-3);
Sepal_Length WITH Sepal_Width(4);
Sepal_Length WITH Petal_Length(5);
Sepal_Width WITH Petal_Length(6);
ANALYSIS: Type is mixture;
OUTPUT: TECH1 TECH11;</code></pre>
<p>In the rest of this document, Mplus and mclust are benchmarked. For ease of comparison, the estimated log-likelihood; if these are identical it probably means all of the estimated paramteters are identical (<a href="https://jrosen48.github.io/blog/comparing-mplus-and-mclust-output/">other benchmarks we have done</a> with Mplus and mclust have demonstrated this).</p>
</div>
<div id="using-the-built-in-iris-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-built-in-iris-dataset" class="anchor"></a>Using the built-in iris dataset</h1>
<div id="profiles" class="section level3">
<h3 class="hasAnchor">
<a href="#profiles" class="anchor"></a>2 profiles</h3>
<p><strong>Mplus</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m2_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m3_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m4_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">4</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m5_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span></code></pre></div>
<p><strong>mclust</strong></p>
<p>Note that model 4 can only be specified in Mplus, so is not included here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 489.026</span>
<span class="co">#&gt; AIC is 1004.052</span>
<span class="co">#&gt; CAIC is 1056.19</span>
<span class="co">#&gt; BIC is 1043.19</span>
<span class="co">#&gt; SABIC is 1002.048</span>
<span class="co">#&gt; ICL is 1043.796</span>
<span class="co">#&gt; Entropy is 0.998</span>

m2_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 297.194</span>
<span class="co">#&gt; AIC is 632.388</span>
<span class="co">#&gt; CAIC is 708.59</span>
<span class="co">#&gt; BIC is 689.59</span>
<span class="co">#&gt; SABIC is 629.459</span>
<span class="co">#&gt; ICL is 689.591</span>
<span class="co">#&gt; Entropy is 1</span>

m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; Fit varying means and variances, covariances fixed to 0 (Model 3) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 393.115</span>
<span class="co">#&gt; AIC is 820.229</span>
<span class="co">#&gt; CAIC is 888.41</span>
<span class="co">#&gt; BIC is 871.41</span>
<span class="co">#&gt; SABIC is 817.608</span>
<span class="co">#&gt; ICL is 871.41</span>
<span class="co">#&gt; Entropy is 1</span>

m5_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; Fit varying means, variances, and covariances (Model 4) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 223.602</span>
<span class="co">#&gt; AIC is 505.204</span>
<span class="co">#&gt; CAIC is 621.513</span>
<span class="co">#&gt; BIC is 592.513</span>
<span class="co">#&gt; SABIC is 500.733</span>
<span class="co">#&gt; ICL is 592.516</span>
<span class="co">#&gt; Entropy is 1</span></code></pre></div>
<p>Here is a summary of the log-likelihood statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)

iris_log_lik &lt;-<span class="st"> </span><span class="kw">tribble</span>(
    <span class="op">~</span>model, <span class="op">~</span>mplus, <span class="op">~</span>mclust,
    <span class="dv">1</span>, <span class="fl">488.915</span>, <span class="fl">488.915</span>,
    <span class="dv">2</span>, <span class="fl">296.448</span>, <span class="fl">296.448</span>,
    <span class="dv">3</span>, <span class="fl">386.185</span>, <span class="fl">386.185</span>,
    <span class="dv">4</span>, <span class="fl">278.544</span>, <span class="ot">NA</span>,
    <span class="dv">5</span>, <span class="fl">214.355</span>, <span class="fl">214.355</span>
)

iris_log_lik
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   model   mplus  mclust</span>
<span class="co">#&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1 488.915 488.915</span>
<span class="co">#&gt; 2     2 296.448 296.448</span>
<span class="co">#&gt; 3     3 386.185 386.185</span>
<span class="co">#&gt; 4     4 278.544      NA</span>
<span class="co">#&gt; 5     5 214.355 214.355</span></code></pre></div>
</div>
<div id="profiles-1" class="section level3">
<h3 class="hasAnchor">
<a href="#profiles-1" class="anchor"></a>3 profiles</h3>
<p>What if we specify 3 profiles?</p>
<p><strong>Mplus</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m2_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m3_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m4_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">4</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m5_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                                  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                  <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                  <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = Sepal_Length Sepal_Width Petal_Length Petal_Width; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span></code></pre></div>
<p><strong>mclust</strong></p>
<p>Note that model 4 can only be specified in Mplus, so is not included here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 362.153</span>
<span class="co">#&gt; AIC is 760.305</span>
<span class="co">#&gt; CAIC is 832.497</span>
<span class="co">#&gt; BIC is 814.497</span>
<span class="co">#&gt; SABIC is 757.53</span>
<span class="co">#&gt; ICL is 820.898</span>
<span class="co">#&gt; Entropy is 0.982</span>

m2_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 257.748</span>
<span class="co">#&gt; AIC is 563.497</span>
<span class="co">#&gt; CAIC is 659.752</span>
<span class="co">#&gt; BIC is 635.752</span>
<span class="co">#&gt; SABIC is 559.797</span>
<span class="co">#&gt; ICL is 641.519</span>
<span class="co">#&gt; Entropy is 0.983</span>

m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; Fit varying means and variances, covariances fixed to 0 (Model 3) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 312.881</span>
<span class="co">#&gt; AIC is 677.761</span>
<span class="co">#&gt; CAIC is 782.038</span>
<span class="co">#&gt; BIC is 756.038</span>
<span class="co">#&gt; SABIC is 673.753</span>
<span class="co">#&gt; ICL is 761.386</span>
<span class="co">#&gt; Entropy is 0.984</span>

m5_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(iris,
                                 Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                                 <span class="dt">n_profiles =</span> <span class="dv">3</span>,
                                 <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; Fit varying means, variances, and covariances (Model 4) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 192.701</span>
<span class="co">#&gt; AIC is 473.402</span>
<span class="co">#&gt; CAIC is 649.87</span>
<span class="co">#&gt; BIC is 605.87</span>
<span class="co">#&gt; SABIC is 466.618</span>
<span class="co">#&gt; ICL is 611.676</span>
<span class="co">#&gt; Entropy is 0.983</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)

iris_log_lik_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">tribble</span>(
    <span class="op">~</span>model, <span class="op">~</span>mplus, <span class="op">~</span>mclust,
    <span class="dv">1</span>, <span class="fl">361.426</span>, <span class="fl">361.429</span>,
    <span class="dv">2</span>, <span class="fl">256.354</span>, <span class="fl">256.355</span>,
    <span class="dv">3</span>, <span class="fl">307.178</span>, <span class="fl">307.181</span>,
    <span class="dv">4</span>, <span class="fl">229.004</span>, <span class="ot">NA</span>,
    <span class="dv">5</span>, <span class="fl">180.185</span>, <span class="fl">180.186</span>
)

iris_log_lik_<span class="dv">3</span>
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   model   mplus  mclust</span>
<span class="co">#&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1 361.426 361.429</span>
<span class="co">#&gt; 2     2 256.354 256.355</span>
<span class="co">#&gt; 3     3 307.178 307.181</span>
<span class="co">#&gt; 4     4 229.004      NA</span>
<span class="co">#&gt; 5     5 180.185 180.186</span></code></pre></div>
</div>
</div>
<div id="using-the-built-in-old-faithful-geyser-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-built-in-old-faithful-geyser-dataset" class="anchor"></a>Using the built-in old faithful geyser dataset</h1>
<p><strong>Mplus</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m1_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = eruptions waiting; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m2_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = eruptions waiting; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m3_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = eruptions waiting; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m4_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">4</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = eruptions waiting; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span>

m5_mplus &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(faithful,
                                  eruptions, waiting,
                                  <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                  <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; TITLE: Your title goes here</span>
<span class="co">#&gt; DATA: FILE = "d.dat";</span>
<span class="co">#&gt; VARIABLE: </span>
<span class="co">#&gt; NAMES = eruptions waiting; </span>
<span class="co">#&gt; MISSING=.;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Running model: t.inp </span>
<span class="co">#&gt; System command: cd "/Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles" &amp;&amp; "/Applications/Mplus/mplus" "t.inp" </span>
<span class="co">#&gt; Reading model:  /Users/joshuarosenberg/Dropbox/1_Research/tidymixmod/docs/articles/t.out</span></code></pre></div>
<p><strong>mclust</strong></p>
<p>Note that model 4 can only be specified in Mplus, so is not included here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1192.408</span>
<span class="co">#&gt; AIC is 2398.815</span>
<span class="co">#&gt; CAIC is 2431.056</span>
<span class="co">#&gt; BIC is 2424.056</span>
<span class="co">#&gt; SABIC is 2401.861</span>
<span class="co">#&gt; ICL is 2427.345</span>
<span class="co">#&gt; Entropy is 0.995</span>

m2_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1140.261</span>
<span class="co">#&gt; AIC is 2296.522</span>
<span class="co">#&gt; CAIC is 2333.368</span>
<span class="co">#&gt; BIC is 2325.368</span>
<span class="co">#&gt; SABIC is 2300.002</span>
<span class="co">#&gt; ICL is 2326.838</span>
<span class="co">#&gt; Entropy is 0.998</span>

m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">3</span>)
<span class="co">#&gt; Fit varying means and variances, covariances fixed to 0 (Model 3) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1229.206</span>
<span class="co">#&gt; AIC is 2476.412</span>
<span class="co">#&gt; CAIC is 2517.865</span>
<span class="co">#&gt; BIC is 2508.865</span>
<span class="co">#&gt; SABIC is 2480.328</span>
<span class="co">#&gt; ICL is 2514.469</span>
<span class="co">#&gt; Entropy is 0.992</span>

m5_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(faithful,
                                 eruptions, waiting,
                                 <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                                 <span class="dt">model =</span> <span class="dv">5</span>)
<span class="co">#&gt; Fit varying means, variances, and covariances (Model 4) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1130.511</span>
<span class="co">#&gt; AIC is 2283.022</span>
<span class="co">#&gt; CAIC is 2333.686</span>
<span class="co">#&gt; BIC is 2322.686</span>
<span class="co">#&gt; SABIC is 2287.808</span>
<span class="co">#&gt; ICL is 2323.09</span>
<span class="co">#&gt; Entropy is 0.999</span></code></pre></div>
<p>Here is a summary of the log-likelihood statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tibble)

geyser_log_lik &lt;-<span class="st"> </span><span class="kw">tribble</span>(
    <span class="op">~</span>model, <span class="op">~</span>mplus, <span class="op">~</span>mclust,
    <span class="dv">1</span>, <span class="fl">1157.68</span>, <span class="fl">1157.68</span>,
    <span class="dv">2</span>, <span class="fl">1140.187</span>, <span class="fl">1140.187</span>,
    <span class="dv">3</span>, <span class="fl">1147.806</span>, <span class="fl">1147.806</span>,
    <span class="dv">4</span>, <span class="fl">1131.970</span>, <span class="ot">NA</span>,
    <span class="dv">5</span>, <span class="fl">1130.264</span>, <span class="fl">1130.264</span>
)

geyser_log_lik
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   model    mplus   mclust</span>
<span class="co">#&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1 1157.680 1157.680</span>
<span class="co">#&gt; 2     2 1140.187 1140.187</span>
<span class="co">#&gt; 3     3 1147.806 1147.806</span>
<span class="co">#&gt; 4     4 1131.970       NA</span>
<span class="co">#&gt; 5     5 1130.264 1130.264</span></code></pre></div>
</div>
<div id="next-steps" class="section level1">
<h1 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next steps</h1>
<p>Finding conditions when the models do differ is an important consideration; these differences, when encountered, are probably due to two reasons:</p>
<ol style="list-style-type: decimal">
<li>Different initialization routines: Mplus uses random starts, and while mclust can use random starts, it defaults to using hierarchical clustering to initialize.</li>
<li>Different estimation methods: Both use Expectation-Maximization (EM) maximum likelihood estimation methods, though Mplus may use an estimator which is more robust to non-normal distributions.</li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#using-the-built-in-iris-dataset">Using the built-in iris dataset</a></li>
      <li><a href="#using-the-built-in-old-faithful-geyser-dataset">Using the built-in old faithful geyser dataset</a></li>
      <li><a href="#next-steps">Next steps</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua M Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
