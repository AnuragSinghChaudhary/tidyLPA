<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to tidyLPA • tidyLPA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tidyLPA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to tidyLPA</h1>
                        <h4 class="author">Joshua M. Rosenberg</h4>
            
            <h4 class="date">2017-11-29</h4>
          </div>

    
    
<div class="contents">
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h1>
<p><code>tidyLPA</code> provides an interface to the powerful <code>mclust</code> package to easily carry out Latent Profile Analysis (LPA). Its main contribution is corresponding that are commonly specified when carrying out LPA. Its secondary contribution is to make it easier to use the output in subsequent analysis through a tidy user interface, in that output is in the form of a <code>tibble</code> (closely related to a <code>data.frame</code>) that can subsequently be computed on.</p>
<p>The goal of <code>tidyLPA</code> is to provide tools to make it easier to use the <code>R</code> package <a href="http://www.stat.washington.edu/mclust/">mclust</a> for Latent Profile Analysis analyses.</p>
<p><code>tidyLPA</code> has been benchmarked to MPlus, at least for a simple dataset (the <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">iris dataset</a>) and with three of the more common model specifications. You can find the results of that benchmarking, which showed the results to be nearly identical, <a href="https://jrosen48.github.io/blog/comparing-mplus-and-mclust-output/">here</a>.</p>
</div>
<div id="example" class="section level1">
<h1 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h1>
<pre><code>#&gt; Loading tidyLPA</code></pre>
<p>Here is a very short example using the built-in dataset <code>pisaUSA15</code>.</p>
<p>First, install the package from GitHub:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"jrosen48/tidyLPA"</span>)</code></pre></div>
<p>Here is the simple example, using just a subset of the built-in <code>pisaUSA15</code> data, data from the 2015 PISA assessment (more details can be found <a href="https://github.com/jrosen48/pisaUSA15">here</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyLPA)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)
d &lt;-<span class="st"> </span>pisaUSA15[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, ]
m3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">n_profiles =</span> <span class="dv">3</span>, <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 3 profiles.</span>
<span class="co">#&gt; LogLik is 281.206</span>
<span class="co">#&gt; AIC is 596.412</span>
<span class="co">#&gt; CAIC is 656.648</span>
<span class="co">#&gt; BIC is 639.648</span>
<span class="co">#&gt; SABIC is 585.979</span>
<span class="co">#&gt; ICL is 669.316</span>
<span class="co">#&gt; Entropy is 0.865</span>
<span class="kw"><a href="../reference/plot_profiles_lpa.html">plot_profiles_lpa</a></span>(m3)
<span class="co">#&gt; Warning: attributes are not identical across measure variables;</span>
<span class="co">#&gt; they will be dropped</span>
<span class="co">#&gt; Warning: Removed 9 rows containing missing values (geom_col).</span>
<span class="co">#&gt; Warning: Removed 18 rows containing missing values (geom_errorbar).</span></code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="more-in-depth-examples" class="section level1">
<h1 class="hasAnchor">
<a href="#more-in-depth-examples" class="anchor"></a>More in-depth examples</h1>
<p>Here are more in-depth examples.</p>
<div id="a-data-first-tidy-approach" class="section level3">
<h3 class="hasAnchor">
<a href="#a-data-first-tidy-approach" class="anchor"></a>A data-first, tidy approach</h3>
<p><code>tidyLPA</code> is presently designed to be used in two ways:</p>
<ol style="list-style-type: decimal">
<li><p>In a “data-first” (or tidy) way, akin to the interface popularized in the <code>dplyr</code> and <code>tidyr</code> (and other) packages - this approach is termed a “<a href="https://www.tidyverse.org/">tidy</a>” approach in large parts of the R users community</p></li>
<li><p>In a more conventional, object-oriented way - this approach will be familiar to those who have used functions such as the built-in <code>lm()</code> function for general linear models (i.e., regression and ANOVA)</p></li>
</ol>
<p>This example makes use of the first, data-first, tidy approach, in which a <code>data.frame</code> (or a <code>tibble</code> to those who use packages such as <code>dplyr</code> and other “tidy” packages) is both input and output by the main function in this package.</p>
<p>Using the built-in <code>pisaUSA15</code> dataset (using just 200 observations for illustrative purposes) and variables for broad interest, enjoyment, and self-efficacy, we can explore a three profile solution, with, for example, <code>4</code> profiles, and varying means across profiles, but equal variances and covariances (specified with model = <code>2</code>, which happens to be the default model if none is specified). More information the models described later in this vignette. Note that the number of profiles are typically chosen on the basis of evidence from multiple sources, including information criteria, statistical tests, and concerns of interpretability and parsimony.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyLPA)
<span class="kw">library</span>(dplyr, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)
d &lt;-<span class="st"> </span>pisaUSA15
d &lt;-<span class="st"> </span><span class="kw">sample_n</span>(pisaUSA15, <span class="dv">500</span>)
<span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">n_profiles =</span> <span class="dv">4</span>, <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 1417.707</span>
<span class="co">#&gt; AIC is 2877.415</span>
<span class="co">#&gt; CAIC is 2985.711</span>
<span class="co">#&gt; BIC is 2964.711</span>
<span class="co">#&gt; SABIC is 2898.061</span>
<span class="co">#&gt; ICL is 3513.874</span>
<span class="co">#&gt; Entropy is 0.584</span>
<span class="co">#&gt; # A tibble: 472 x 5</span>
<span class="co">#&gt;    broad_interest enjoyment self_efficacy profile posterior_prob</span>
<span class="co">#&gt;             &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1            3.6       3.0         2.375       3        0.49209</span>
<span class="co">#&gt;  2            3.0       4.0         2.000       3        0.71831</span>
<span class="co">#&gt;  3            1.6       3.0         2.000       1        0.70876</span>
<span class="co">#&gt;  4            2.6       2.0         2.875       1        0.56214</span>
<span class="co">#&gt;  5            3.4       4.0         4.000       3        0.87566</span>
<span class="co">#&gt;  6            2.4       1.8         1.000       2        0.93695</span>
<span class="co">#&gt;  7            2.4       2.2         2.875       1        0.61672</span>
<span class="co">#&gt;  8            2.4       3.0         2.875       1        0.55210</span>
<span class="co">#&gt;  9            2.8       3.4         1.500       3        0.38225</span>
<span class="co">#&gt; 10            3.2       3.0         2.750       3        0.41200</span>
<span class="co">#&gt; # ... with 462 more rows</span></code></pre></div>
<p>**Note that if you get the warning “Some profiles are associated with no assignments. Interpret this solution with caution and consider other models”, then this is a sign that a simpler model (with fewer profiles) likely fits better.</p>
<p>You can see the output is simply the same <code>tibble</code> that is input as the first function to <code>create_profiles_LPA</code>, but modified so that the classification and posterior probability of the classification are added (and incomplete cases with respect to the variables used to estimate the profiles removed).</p>
<p>We can then plot this output using the <code><a href="../reference/plot_profiles_lpa.html">plot_profiles_lpa()</a></code> function and the pipe (<code>%&gt;%</code>) from the <code>dplyr</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">n_profiles =</span> <span class="dv">4</span>, <span class="dt">model =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="../reference/plot_profiles_lpa.html">plot_profiles_lpa</a></span>()
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 1417.707</span>
<span class="co">#&gt; AIC is 2877.415</span>
<span class="co">#&gt; CAIC is 2985.711</span>
<span class="co">#&gt; BIC is 2964.711</span>
<span class="co">#&gt; SABIC is 2898.061</span>
<span class="co">#&gt; ICL is 3513.874</span>
<span class="co">#&gt; Entropy is 0.584</span>
<span class="co">#&gt; Warning: attributes are not identical across measure variables;</span>
<span class="co">#&gt; they will be dropped</span>
<span class="co">#&gt; Warning: Removed 12 rows containing missing values (geom_col).</span>
<span class="co">#&gt; Warning: Removed 24 rows containing missing values (geom_errorbar).</span></code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>You can, if you like, use the arguments <code>center_raw_data</code> (to center all of the clustering variables to have a mean of 0) or <code>scale_raw_data</code> (to scale all of the clustering variables to have a standard deviation of 1) in <code><a href="../reference/create_profiles_lpa.html">create_profiles_lpa()</a></code>.</p>
<p>Below is identical to the two lines of code above, except that instead of using the pipe, we save the output the object <code>m3</code>, and then call the <code><a href="../reference/plot_profiles_lpa.html">plot_profiles_lpa()</a></code> function on the output that it points to.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">n_profiles =</span> <span class="dv">4</span>, <span class="dt">model =</span> <span class="dv">2</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 1417.707</span>
<span class="co">#&gt; AIC is 2877.415</span>
<span class="co">#&gt; CAIC is 2985.711</span>
<span class="co">#&gt; BIC is 2964.711</span>
<span class="co">#&gt; SABIC is 2898.061</span>
<span class="co">#&gt; ICL is 3513.874</span>
<span class="co">#&gt; Entropy is 0.584</span>
<span class="kw"><a href="../reference/plot_profiles_lpa.html">plot_profiles_lpa</a></span>(m3, <span class="dt">to_center =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>We can also return all of the data. This returns a <code>tibble</code> with all of the variables in the original data, in this case <code>d</code>, so that subsequent analyses using variables that are not used to create the profile can be easily carried out.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">n_profiles =</span> <span class="dv">4</span>, <span class="dt">model =</span> <span class="dv">2</span>, <span class="dt">return_orig_df =</span> T)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 1417.707</span>
<span class="co">#&gt; AIC is 2877.415</span>
<span class="co">#&gt; CAIC is 2985.711</span>
<span class="co">#&gt; BIC is 2964.711</span>
<span class="co">#&gt; SABIC is 2898.061</span>
<span class="co">#&gt; ICL is 3513.874</span>
<span class="co">#&gt; Entropy is 0.584</span>
<span class="co">#&gt; # A tibble: 472 x 6</span>
<span class="co">#&gt;    broad_interest enjoyment instrumental_mot self_efficacy profile</span>
<span class="co">#&gt;             &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1            3.6       3.0             2.00         2.375       3</span>
<span class="co">#&gt;  2            3.0       4.0             1.00         2.000       3</span>
<span class="co">#&gt;  3            1.6       3.0             2.00         2.000       1</span>
<span class="co">#&gt;  4            2.6       2.0             2.25         2.875       1</span>
<span class="co">#&gt;  5            3.4       4.0             1.00         4.000       3</span>
<span class="co">#&gt;  6            2.4       1.8             1.75         1.000       2</span>
<span class="co">#&gt;  7            2.4       2.2             2.00         2.875       1</span>
<span class="co">#&gt;  8            2.4       3.0             4.00         2.875       1</span>
<span class="co">#&gt;  9            2.8       3.4             1.00         1.500       3</span>
<span class="co">#&gt; 10            3.2       3.0             2.00         2.750       3</span>
<span class="co">#&gt; # ... with 462 more rows, and 1 more variables: posterior_prob &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="an-object-oriented-approach" class="section level3">
<h3 class="hasAnchor">
<a href="#an-object-oriented-approach" class="anchor"></a>An object-oriented approach</h3>
<p>In addition to being used as part of a “tidy” approach, there is also an option to use it as part of a more conventional, object-oriented approach. In this example, instead of outputting a <code>tibble</code>, we will output an object of class <code>Mclust</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span>pisaUSA15
d &lt;-<span class="st"> </span><span class="kw">sample_n</span>(pisaUSA15, <span class="dv">500</span>)
m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_lpa.html">create_profiles_lpa</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">n_profiles =</span> <span class="dv">2</span>, <span class="dt">model =</span> <span class="dv">2</span>, <span class="dt">to_return =</span> <span class="st">"mclust"</span>)
<span class="co">#&gt; Fit varying means, equal variances and covariances (Model 2) model with 2 profiles.</span>
<span class="co">#&gt; LogLik is 1408.09</span>
<span class="co">#&gt; AIC is 2842.18</span>
<span class="co">#&gt; CAIC is 2909.137</span>
<span class="co">#&gt; BIC is 2896.137</span>
<span class="co">#&gt; SABIC is 2854.878</span>
<span class="co">#&gt; ICL is 2960.507</span>
<span class="co">#&gt; Entropy is 0.941</span></code></pre></div>
<p>Any of the functions from the <a href="http://www.stat.washington.edu/mclust/">mclust package</a> that work with this type of output will work on this output; the only difference is that the model is specified in this package (with the <code><a href="../reference/create_profiles_lpa.html">create_profiles_lpa()</a></code> function) instead of the <code>Mclust()</code> function from the <code>mclust package</code>.</p>
</div>
</div>
<div id="models" class="section level1">
<h1 class="hasAnchor">
<a href="#models" class="anchor"></a>Models</h1>
<p>As mentioned earlier, there are a number of different models representing different covariance matrix parameterizations that can be fit using <code>tidyLPA</code>. These are passed to the <code>model</code> argument to the <code><a href="../reference/create_profiles_lpa.html">create_profiles_lpa()</a></code> function, i.e. <code><a href="../reference/create_profiles_lpa.html">create_profiles_lpa(d, broad_interest, enjoyment, self_efficacy, n_profiles = 3, model = 2, to_return="tibble")</a></code>.</p>
<p>In general, the approach to choosing the model is similar to choosing the number of profiles, requiring deciding on the basis of evidence from multiple sources, including information criteria, statistical tests, and concerns of interpretability and parsimony.</p>
<p>Here is more information on their specification, drawing from <a href="http://www.sciencedirect.com/science/article/pii/S0361476X06000543">Pastor’s (2007)</a> article.</p>
<p>A few notes:</p>
<ul>
<li><p><em>p</em> represents different profiles (or mixture components).</p></li>
<li><p>each covariance parameterization is represented by a 4 x 4 covariance matrix and therefore would represent the parameterization for a four-profile solution.</p></li>
</ul>
<p><strong>A. Varying means, equal variances, covariances fixed to 0 (model 1)</strong></p>
<p><em>corresponds to the mclust model “EEI”, “diagonal, equal volume and shape”</em></p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1 }^{ 2 } &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; { \sigma  }_{ 2 }^{ 2 } &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; { \sigma  }_{ 3 }^{ 2 } &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; { \sigma  }_{ 4 }^{ 2 } \end{matrix} \right] 
\]</span></p>
<p><strong>B. Varying means, equal variances and covariances (model 2)</strong></p>
<p><em>corresponds to the mclust model “EEE”, “ellipsoidal, equal volume, shape, and orientation”</em></p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1 }^{ 2 } &amp; { \sigma  }_{ 21 } &amp; { \sigma  }_{ 31 } &amp; { \sigma  }_{ 41 } \\ { \sigma  }_{ 12 } &amp; { \sigma  }_{ 2 }^{ 2 } &amp; { \sigma  }_{ 23 } &amp; { \sigma  }_{ 24 } \\ { \sigma  }_{ 13 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 3 }^{ 2 } &amp; { \sigma  }_{ 33 } \\ { \sigma  }_{ 14 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 4 }^{ 2 } \end{matrix} \right] 
\]</span></p>
<p><strong>C. Varying means and variances, covariances fixed to 0 (model 3)</strong></p>
<p><em>corresponds to the mclust model “VVI”, “diagonal, varying volume and shape”</em></p>
<p><span class="math display">\[ 
\left[ \begin{matrix} { \sigma  }_{ 1p }^{ 2 } &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; { \sigma  }_{ 2p }^{ 2 } &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; { \sigma  }_{ 3p }^{ 2 } &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; { \sigma  }_{ 4p }^{ 2 } \end{matrix} \right] 
\]</span></p>
<p><strong>D. Varying means and variances, equal covariances (model 4)</strong></p>
<p><em>While used in some applications of Latent Profile Analysis, this model cannot presently be specified in mclust</em></p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1p }^{ 2 } &amp; { \sigma  }_{ 21 } &amp; { \sigma  }_{ 31 } &amp; { \sigma  }_{ 41 } \\ { \sigma  }_{ 12 } &amp; { \sigma  }_{ 2p }^{ 2 } &amp; { \sigma  }_{ 23 } &amp; { \sigma  }_{ 24 } \\ { \sigma  }_{ 13 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 3p }^{ 2 } &amp; { \sigma  }_{ 33 } \\ { \sigma  }_{ 14 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 4p }^{ 2 } \end{matrix} \right] 
\]</span></p>
<p><strong>E. Varying means, variances, and covariances</strong></p>
<p><em>corresponds to the mclust model “VVV”, “ellipsoidal, varying volume, shape, and orientation”</em></p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1p }^{ 2 } &amp; { \sigma  }_{ 21p } &amp; { \sigma  }_{ 31p } &amp; { \sigma  }_{ 41p } \\ { \sigma  }_{ 12p } &amp; { \sigma  }_{ 2p }^{ 2 } &amp; { \sigma  }_{ 23p } &amp; { \sigma  }_{ 24p } \\ { \sigma  }_{ 13p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 3p }^{ 2 } &amp; { \sigma  }_{ 33p } \\ { \sigma  }_{ 14p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 4p }^{ 2 } \end{matrix} \right] 
\]</span></p>
</div>
<div id="comparing-many-models-using-information-criteria" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-many-models-using-information-criteria" class="anchor"></a>Comparing many models using information criteria</h1>
<p>We can quickly explore a number of models - both in terms of <strong>the specification of the model</strong> and <strong>the number of profiles</strong> using the Bayesian Information Criteria (BIC) values or the Integrated Completed Likelihood (ICL). For illustration, the built-in (to R) iris dataset is used a number of the models using the PISA data do not reach convergence.</p>
<p><strong>Note that although BIC and ICL statistics may appear for the combination of a particular model and number of profiles, the output for these models may have profiles with no observations assigned to them, and so these statistics and figures should be considered starting points, not the sole criterion on which to decide on which model to select.</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/compare_models_lpa.html">compare_models_lpa</a></span>(iris, Sepal.Length, Sepal.Width, Petal.Length, Petal.Width, <span class="dt">statistic =</span> <span class="st">"BIC"</span>)</code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-11-1.png" width="720"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/compare_models_lpa.html">compare_models_lpa</a></span>(iris, Sepal.Length, Sepal.Width, Petal.Length, Petal.Width, <span class="dt">statistic =</span> <span class="st">"ICL"</span>)</code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-11-2.png" width="720"></p>
</div>
<div id="bootstrapped-likelihood-ratio-test" class="section level1">
<h1 class="hasAnchor">
<a href="#bootstrapped-likelihood-ratio-test" class="anchor"></a>Bootstrapped likelihood-ratio test</h1>
<p>To determine the number of profies for a specified model (i.e., models <code>1</code>-<code>4</code> described above, we can carry out a bootstrapped likelihood-ratio test. Note that the code is shown but run because it can take substantial time, even for a small dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/bootstrap_lrt.html">bootstrap_lrt</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">model =</span> <span class="dv">3</span>)</code></pre></div>
</div>
<div id="run-the-same-models-through-mplus" class="section level1">
<h1 class="hasAnchor">
<a href="#run-the-same-models-through-mplus" class="anchor"></a>Run the same models through Mplus</h1>
<p>There is an in-development function to generate the model syntax (and prepare the data) and run the same models through the Mplus software:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/create_profiles_mplus.html">create_profiles_mplus</a></span>(iris,
                            Sepal.Length, Sepal.Width, Petal.Length, Petal.Width,
                            <span class="dt">n_profiles =</span> <span class="dv">2</span>,
                            <span class="dt">model =</span> <span class="dv">1</span>)
<span class="co">#&gt; Warning in as.POSIXlt.POSIXct(x, tz): unknown timezone 'zone/tz/2017c.1.0/</span>
<span class="co">#&gt; zoneinfo/America/Detroit'</span></code></pre></div>
<p>The object <code>m1</code> contains the Mplus output, as is returned in Mplus, but in an R list; for quick comparisons, <code><a href="../reference/create_profiles_mplus.html">create_profiles_mplus()</a></code> prints the log-likelihood, BIC, and entropy statistics.</p>
</div>
<div id="notes" class="section level1">
<h1 class="hasAnchor">
<a href="#notes" class="anchor"></a>Notes</h1>
<ul>
<li><p>This is a sister-project to <a href="https://github.com/jrosen48/prcr">prcr</a>, for two-step cluster analysis.</p></li>
<li><p><a href="http://www.sciencedirect.com/science/article/pii/S0361476X06000543">Pastor (2007)</a> provides an accessible introduction to LPA, with an applied example in educational research.</p></li>
<li><p>To contribute, file issues via GitHub <a href="https://github.com/jrosen48/tidyLPA/issues">here</a> or get in touch <a href="https://jrosen48.github.io/about/">via email or Twitter</a>.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#example">Example</a></li>
      <li><a href="#more-in-depth-examples">More in-depth examples</a></li>
      <li><a href="#models">Models</a></li>
      <li><a href="#comparing-many-models-using-information-criteria">Comparing many models using information criteria</a></li>
      <li><a href="#bootstrapped-likelihood-ratio-test">Bootstrapped likelihood-ratio test</a></li>
      <li><a href="#run-the-same-models-through-mplus">Run the same models through Mplus</a></li>
      <li><a href="#notes">Notes</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua M Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
