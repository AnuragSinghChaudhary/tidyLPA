<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to tidyLPA • tidyLPA</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">tidyLPA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to tidyLPA</h1>
                        <h4 class="author">Joshua M. Rosenberg</h4>
            
            <h4 class="date">2018-02-14</h4>
          </div>

    
    
<div class="contents">
<p>This introduction to tidyLPA vignette is an overview of the tidyLPA package. This vignette covers the following topics:</p>
<ol style="list-style-type: decimal">
<li>Background on Latent Profile Analysis</li>
<li>Description of the goals of tidyLPA</li>
<li>Software approach to carrying out LPA: Interface to mclust (and to MPlus)</li>
<li>An example</li>
<li>More information on model specification</li>
<li>An interface to MPlus (in-development)</li>
<li>Other features</li>
<li>Conclusion</li>
</ol>
<div id="background-on-latent-profile-analysis-lpa" class="section level2">
<h2 class="hasAnchor">
<a href="#background-on-latent-profile-analysis-lpa" class="anchor"></a>1. Background on Latent Profile Analysis (LPA)</h2>
<p>Latent Profile Analysis (LPA) is a statistical modeling approach for estimating distinct profiles of variables. In the social sciences and in educational research, these profiles could represent, for example, how different youth experience dimensions of being engaged (i.e., cognitively, behaviorally, and affectively) at the same time.</p>
<p>Many analysts have carried out LPA using a latent variable modeling approach. From this approach, different parameters - means, variances, and covariances - are freely estimated across profiles, fixed to be the same across profiles, or constrained to be zero. The MPlus software is commonly used to estimate these models (see <a href="https://www.statmodel.com/examples/mixture.shtml">here</a>) using the expectation-maximization (EM) algorithm to obtain the maximum likelihood estimates for the parameters.</p>
<p>Different <em>models</em> (or how or whether parameters are estimated), such as models that allow only the means and variances to be freely estimated across profiles, and other common combinations in terms of estimating the means, variances, and covariances, can be specified and estimated. While MPlus is widely-used (and powerful), it is costly, closed-source, and can be difficult to use, particularly with respect to interpreting or using the output of specified models as part of a reproducible workflow.</p>
</div>
<div id="description-of-the-goals-of-tidylpa" class="section level2">
<h2 class="hasAnchor">
<a href="#description-of-the-goals-of-tidylpa" class="anchor"></a>2. Description of the goals of tidyLPA</h2>
<p>The goal of tidyLPA is to make it easy to carry out LPA using R. In particular, tidyLPA provides an interface to the powerful and widely-used <a href="https://www.stat.washington.edu/mclust/">mclust</a> package for Gaussian Mixture Modeling. This means that tidyLPA does not contain code to carry out LPA directly, but rather provides “wrappers” to mclust functions that make them easier to use. The primary contributions of tidyLPA are to:</p>
<ol style="list-style-type: decimal">
<li>Provide functionality to specify models that are common to LPA</li>
<li>Make it easier to use the output in subsequent analysis through a <a href="https://CRAN.R-project.org/package=tidyverse/vignettes/manifesto.html">“tidy” interface</a>, in that:
<ul>
<li>input and output are both a <code>data.frame</code> (specifically its modified version, a <code>tibble</code>) that can be used to create plots or can be used in subsequent analyses</li>
<li>uses the “pipe” operator, <code>%&gt;%</code> to compose functions</li>
<li>being designed and documented to be easy to use, especially for beginners (but also to provide options for finer-grained choices for estimating the model and for viewing more specific forms of the LPA output)</li>
</ul>
</li>
</ol>
</div>
<div id="software-approach-to-carrying-out-lpa-interface-to-mclust-and-to-mplus" class="section level2">
<h2 class="hasAnchor">
<a href="#software-approach-to-carrying-out-lpa-interface-to-mclust-and-to-mplus" class="anchor"></a>3. Software approach to carrying out LPA: Interface to mclust (and to MPlus)</h2>
<p>In the open-source R software, there is not yet a tool to easily carry out LPA, though there are many tools that one could use to. For example, the <a href="https://openmx.ssri.psu.edu/">R version of OpenMx</a> can be used for this purpose (and to specify almost any model possible to specify within a latent variable modeling approach). However, while OpenMx is very flexible, it can also be challenging to use.</p>
<p>Other tools in R allow for estimating Gaussian mixture models, or models of multivariate Gaussian (or normal) distributions. In this framework, the term “mixture component” has a similar meaning to a profile. While much more constraining than the latent variable modeling framework, the approach is often similar or the same: the EM algorithm is used to (aim to) obtain the maximum likelihood estimates for the parameters being estimated. Like in the latent variable modeling framework, different models can be specified.</p>
<p>In addition to following the same general approach, using tools that are designed for Gaussian mixture modeling have other benefits, some efficiency-related (see <a href="https://cran.r-project.org/package=Rmixmod">RMixMod</a>, which uses compiled C++ code) and others in terms of ease-of-use (i.e., the plot methods built-in to RMixMod, mclust, and other tools). However, they also have some drawbacks, in that it can be difficult to translate between the model specifications, which are often described in terms of the geometric properties of the multivariate distributions being estimated (i.e., “spherical, equal volume”), rather than in terms of how the means, variances, and covariances are estimated. They also may use different default settings (than those encountered in MPlus) in terms of the expectation-maximization algorithm, which can make comparing results across tools challenging.</p>
<p>The approach taken is this package it to provide an interface or “wrapper” to to an open-source and widely-used package for Gaussian mixture modeling, mclust. It focuses on models that are commonly specified as part of LPA. The use of mclust to carry out LPA has been benchmarked to MPlus, at least for simple models.</p>
<p>This <a href="https://jrosen48.github.io/r-markdown/comparing-mplus-mclust.html">R Markdown output</a> contains comprehensive information on how mclust and Mplus compare. The R Markdown to generate the output is also available <a href="https://jrosen48.github.io/r-markdown/comparing-mplus-mclust.Rmd">here</a>, and, as long as you have purchased MPlus (and installed MplusAutomation), can be used to replicate all of the results for the benchmark. Here are the log-likelihoods for the comparison. Note that most are the same, there are some differences in the hundreths decimal places for some.</p>
<p>Here are the log-likelihoods for a series of models (models 1, 2, 3, and 6, specified by <code>models =</code> in `estimate_profiles()) for 2 and 3 profile solutions for the built-in (to R) <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">iris</a> and <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/faithful.html">geyser</a> data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris_log_lik_2_profiles
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   model mplus mclust</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.00   489    489</span>
<span class="co">#&gt; 2  2.00   296    296</span>
<span class="co">#&gt; 3  3.00   386    386</span>
<span class="co">#&gt; 4  5.00   214    214</span>
iris_log_lik_3_profiles
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   model mplus mclust</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.00   361    361</span>
<span class="co">#&gt; 2  2.00   256    256</span>
<span class="co">#&gt; 3  3.00   307    307</span>
<span class="co">#&gt; 4  6.00   180    180</span>
geyser_log_lik_2_profiles
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   model mplus mclust</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.00  1158   1158</span>
<span class="co">#&gt; 2  2.00  1140   1140</span>
<span class="co">#&gt; 3  3.00  1148   1148</span>
<span class="co">#&gt; 4  6.00  1130   1130</span></code></pre></div>
<p>Because of differences in settings for the EM algorithm and particularly for the start values (random starts for MPlus and starting values from hierarchical clustering for mclust), differences may be expected for more complex data and models. Note that tidyLPA also provides functions to interface to MPlus, though these are not the focus of the package, as they require MPlus to be purchased and installed in order to be used.</p>
</div>
<div id="an-example-using-mclust" class="section level2">
<h2 class="hasAnchor">
<a href="#an-example-using-mclust" class="anchor"></a>4. An example using mclust</h2>
<p>Here is a very short example using the built-in data set <code>pisaUSA15</code>.</p>
<p>First, you can install the package from CRAN as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"tidyLPA"</span>)</code></pre></div>
<p>Note that this package is in the process of being submitted to CRAN and if it is not available yet, you can install it from GitHub:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"jrosen48/tidyLPA"</span>)</code></pre></div>
<p>Here is the simple example, using just a subset of the built-in <code>pisaUSA15</code> data, data from the 2015 PISA assessment (more details on the data set can be found <a href="https://github.com/jrosen48/pisaUSA15">here</a>). Here, we load tidyLPA and create a subset of the <code>pisaUSA15</code> data for this example. We use variables from the PISA assessment for United States students’ broad interest, enjoyment, and self_efficacy (each which is a composite of other measured, self-report variables).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyLPA)
<span class="co">#&gt; tidyLPA provides the functionality to carry out Latent Profile Analysis. Note that tidyLPA is still at the beta stage! </span>
<span class="co">#&gt; Please report any bugs at https://github.com/jrosen48/tidyLPA or send an email to jrosen@msu.edu.</span>
d &lt;-<span class="st"> </span>pisaUSA15[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, ]</code></pre></div>
<p><strong>Comparing profile solutions</strong></p>
<p>Next, we use the <code><a href="../reference/compare_solutions.html">compare_solutions()</a></code> function to explore different solutions in terms of information criteria, specifically the Bayesian Information Criteria (BIC) (the ICL is also available, as others will be in future versions; add the argument <code>statistic = "ICL"</code> to plot the ICL values instead of the BIC values). The BIC is based on the log-likelihood value for the model, but it accounts for the complexity of the model in terms of its degrees of freedom, penalizing more complex models with higher BICs. The goal of this step is to determine whether certain models and certain numbers of profiles are associated with lower BIC values, which then suggest further, detailed analysis in the next step.</p>
<p>To use the function, we provide the name of the <code>data.frame</code>, <code>d</code>, first, followed by the names of the variables to be used to create the profiles next, separated by commas. This syntax is familiar to those who have used functions such as <code>select()</code> from the <a href="http://dplyr.tidyverse.org/">dplyr</a> package (and other <a href="http://tidyverse.org/">“tidyverse”</a> packages).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/compare_solutions.html">compare_solutions</a></span>(d, broad_interest, enjoyment, self_efficacy)</code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>While these BIC values are ambiguous for this data, Model 1 with 4 profiles is associated with the lowest BIC value (for this model. Many of the other models do not demonstrate clear patterns with respect to the number of profiles, and so this particular solution may be inspected in further detail. Here, we use the <code><a href="../reference/estimate_profiles.html">estimate_profiles()</a></code> function.</p>
<p><strong>Estimating parameters of profiles for a specific solution</strong></p>
<p>Here, we are estimating the parameters (depending on the model specified, means, variances, and covariances) that characterize the profiles. Like the <code><a href="../reference/compare_solutions.html">compare_solutions()</a></code>, the first argument to <code><a href="../reference/estimate_profiles.html">estimate_profiles()</a></code> is the <code>data.frame</code>, <code>d</code>, followed by the names of the variables to be used to create the profiles separated by commas. In addition, we must specify the model (1, with <code>model = 1</code>, as well as the number of profiles (4, <code>n_profiles = 4</code>). When we run the following line, we see a number of statistics - <code>LogLik</code> for the log-likelihood, a number of information criteria (<code>AIC</code>, <code>CAIC</code>, <code>BIC</code>, <code>SABIC</code>, and <code>ICL</code>), as well as the entropy. For the log-likelihood and information criteria statistics, lower values are generally indicative of a preferred solution; for the entropy statistic, higher values are generally indicative of a preferred solution. <a href="https://www.sciencedirect.com/science/article/pii/S0361476X06000543">Pastor, Barron, Miller, and Davis (2007)</a> provide an accessible introduction to interpreting these values. Note that these statistics are printed as messages by default but can be suppressed by adding the argument <code>print_fit_stats = FALSE</code> to <code><a href="../reference/estimate_profiles.html">estimate_profiles()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/estimate_profiles.html">estimate_profiles</a></span>(d, 
                        broad_interest, enjoyment, self_efficacy,
                        <span class="dt">model =</span> <span class="dv">1</span>,
                        <span class="dt">n_profiles =</span> <span class="dv">4</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 271.511</span>
<span class="co">#&gt; BIC is 624.802</span>
<span class="co">#&gt; Entropy is 0.952</span></code></pre></div>
<p>We fit the model and saved the output to the object <code>m3</code>. Next, we may want to examine the output in terms of the estimated means and variances of the variables for each of the profiles. We can do this with the <code><a href="../reference/plot_profiles.html">plot_profiles()</a></code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_profiles.html">plot_profiles</a></span>(m3)</code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>We can also center or standardize the variables (to have grand mean equal to 0 and standard deviation equal t 1, respectively), with the <code>to_center</code> and <code>to_scale</code> arguments to <code><a href="../reference/plot_profiles.html">plot_profiles()</a></code>, i.e.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_profiles.html">plot_profiles</a></span>(m3, <span class="dt">to_center =</span> <span class="ot">TRUE</span>, <span class="dt">to_scale =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Introduction_to_tidyLPA_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p><strong>Other options</strong></p>
<p>There is a lot of output that is possible to obtain from the <code><a href="../reference/estimate_profiles.html">estimate_profiles()</a></code> function - much more than a tidy data frame, which is the default. The easiest way to access it is by changing what is returned; by default, the function returns a <code>data.frame</code> (more precisely, a <code>tibble</code>) with the variables used to create the profiles and the profile with the highest posterior probability (and the posterior probability for the profile):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/estimate_profiles.html">estimate_profiles</a></span>(d,
                  broad_interest, enjoyment, self_efficacy,
                  <span class="dt">model =</span> <span class="dv">1</span>,
                  <span class="dt">n_profiles =</span> <span class="dv">4</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 271.511</span>
<span class="co">#&gt; BIC is 624.802</span>
<span class="co">#&gt; Entropy is 0.952</span>
<span class="co">#&gt; # A tibble: 94 x 5</span>
<span class="co">#&gt;    broad_interest enjoyment self_efficacy profile posterior_prob</span>
<span class="co">#&gt;             &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;fct&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1           3.80      4.00          1.00 1                1.00 </span>
<span class="co">#&gt;  2           3.00      3.00          2.75 4                1.000</span>
<span class="co">#&gt;  3           1.80      2.80          3.38 4                0.965</span>
<span class="co">#&gt;  4           1.40      1.00          2.75 2                1.000</span>
<span class="co">#&gt;  5           1.80      2.20          2.00 3                0.996</span>
<span class="co">#&gt;  6           1.60      1.60          1.88 3                0.963</span>
<span class="co">#&gt;  7           3.00      3.80          2.25 1                0.996</span>
<span class="co">#&gt;  8           2.60      2.20          2.00 3                0.986</span>
<span class="co">#&gt;  9           1.00      2.80          2.62 4                0.908</span>
<span class="co">#&gt; 10           2.20      2.00          1.75 3                1.000</span>
<span class="co">#&gt; # ... with 84 more rows</span></code></pre></div>
<p>We can change the <code>to_return</code> argument to “mclust” to instead return the full output from the estimation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3_mclust &lt;-<span class="st"> </span><span class="kw"><a href="../reference/estimate_profiles.html">estimate_profiles</a></span>(d, 
                               broad_interest, enjoyment, self_efficacy, 
                               <span class="dt">model =</span> <span class="dv">1</span>, 
                               <span class="dt">n_profiles =</span> <span class="dv">4</span>, 
                               <span class="dt">to_return =</span> <span class="st">"mclust"</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 271.511</span>
<span class="co">#&gt; BIC is 624.802</span>
<span class="co">#&gt; Entropy is 0.952</span></code></pre></div>
<p>This object can be inspected manually (see <code>str(m3_clust)</code>) or through helper functions available in mclust, i.e.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3_mclust<span class="op">$</span>parameters
<span class="co">#&gt; $pro</span>
<span class="co">#&gt; [1] 0.20844740 0.04426354 0.31001984 0.43726922</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt;                    [,1]     [,2]     [,3]     [,4]</span>
<span class="co">#&gt; broad_interest 3.089074 1.435974 1.979601 2.712883</span>
<span class="co">#&gt; enjoyment      3.833430 1.071682 2.126969 2.933941</span>
<span class="co">#&gt; self_efficacy  1.500661 2.859656 2.224995 2.147173</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variance</span>
<span class="co">#&gt; $variance$modelName</span>
<span class="co">#&gt; [1] "EEI"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variance$d</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variance$G</span>
<span class="co">#&gt; [1] 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variance$sigma</span>
<span class="co">#&gt; , , 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                broad_interest  enjoyment self_efficacy</span>
<span class="co">#&gt; broad_interest      0.4760132 0.00000000     0.0000000</span>
<span class="co">#&gt; enjoyment           0.0000000 0.05287357     0.0000000</span>
<span class="co">#&gt; self_efficacy       0.0000000 0.00000000     0.3022866</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                broad_interest  enjoyment self_efficacy</span>
<span class="co">#&gt; broad_interest      0.4760132 0.00000000     0.0000000</span>
<span class="co">#&gt; enjoyment           0.0000000 0.05287357     0.0000000</span>
<span class="co">#&gt; self_efficacy       0.0000000 0.00000000     0.3022866</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                broad_interest  enjoyment self_efficacy</span>
<span class="co">#&gt; broad_interest      0.4760132 0.00000000     0.0000000</span>
<span class="co">#&gt; enjoyment           0.0000000 0.05287357     0.0000000</span>
<span class="co">#&gt; self_efficacy       0.0000000 0.00000000     0.3022866</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                broad_interest  enjoyment self_efficacy</span>
<span class="co">#&gt; broad_interest      0.4760132 0.00000000     0.0000000</span>
<span class="co">#&gt; enjoyment           0.0000000 0.05287357     0.0000000</span>
<span class="co">#&gt; self_efficacy       0.0000000 0.00000000     0.3022866</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variance$Sigma</span>
<span class="co">#&gt;                broad_interest  enjoyment self_efficacy</span>
<span class="co">#&gt; broad_interest      0.4760132 0.00000000     0.0000000</span>
<span class="co">#&gt; enjoyment           0.0000000 0.05287357     0.0000000</span>
<span class="co">#&gt; self_efficacy       0.0000000 0.00000000     0.3022866</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variance$scale</span>
<span class="co">#&gt; [1] 0.1966794</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variance$shape</span>
<span class="co">#&gt; [1] 2.4202495 0.2688313 1.5369512</span></code></pre></div>
<p>Other options include how the raw data is processed. We can center or scale the data before estimating the profiles with the <code>center_raw_data</code> and <code>scale_raw_data</code> functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3_processed_raw &lt;-<span class="st"> </span><span class="kw"><a href="../reference/estimate_profiles.html">estimate_profiles</a></span>(d, 
                                      broad_interest, enjoyment, self_efficacy, 
                                      <span class="dt">model =</span> <span class="dv">1</span>, 
                                      <span class="dt">n_profiles =</span> <span class="dv">4</span>, 
                                      <span class="dt">center_raw_data =</span> <span class="ot">TRUE</span>, 
                                      <span class="dt">scale_raw_data =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 356.415</span>
<span class="co">#&gt; BIC is 794.609</span>
<span class="co">#&gt; Entropy is 0.951</span></code></pre></div>
<p>Since we often wish to use the estimated profiles in subsequent analyses, we may want the original <code>data.frame</code>, with variables that are predictors or outcomes of the profiles, included. We can return this <code>data.frame</code>, and not just one with the variables used to create the profiles and the profile assignments (and posterior probabilities), using the argument <code>return_orig_df</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/estimate_profiles.html">estimate_profiles</a></span>(d, 
                  broad_interest, enjoyment, self_efficacy, 
                  <span class="dt">model =</span> <span class="dv">1</span>, 
                  <span class="dt">n_profiles =</span> <span class="dv">4</span>, 
                  <span class="dt">return_orig_df =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Fit varying means, equal variances, covariances fixed to 0 (Model 1) model with 4 profiles.</span>
<span class="co">#&gt; LogLik is 271.511</span>
<span class="co">#&gt; BIC is 624.802</span>
<span class="co">#&gt; Entropy is 0.952</span>
<span class="co">#&gt; # A tibble: 94 x 6</span>
<span class="co">#&gt;    broad_interest enjoyment instrumental_mot self_efficacy profile</span>
<span class="co">#&gt;             &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt; &lt;fct&gt;  </span>
<span class="co">#&gt;  1           3.80      4.00             2.00          1.00 1      </span>
<span class="co">#&gt;  2           3.00      3.00             2.50          2.75 4      </span>
<span class="co">#&gt;  3           1.80      2.80             3.50          3.38 4      </span>
<span class="co">#&gt;  4           1.40      1.00             2.75          2.75 2      </span>
<span class="co">#&gt;  5           1.80      2.20             2.00          2.00 3      </span>
<span class="co">#&gt;  6           1.60      1.60             2.75          1.88 3      </span>
<span class="co">#&gt;  7           3.00      3.80             1.25          2.25 1      </span>
<span class="co">#&gt;  8           2.60      2.20             2.00          2.00 3      </span>
<span class="co">#&gt;  9           1.00      2.80             1.00          2.62 4      </span>
<span class="co">#&gt; 10           2.20      2.00             1.00          1.75 3      </span>
<span class="co">#&gt; # ... with 84 more rows, and 1 more variable: posterior_prob &lt;dbl&gt;</span></code></pre></div>
<p>Future versions will include the option to use random starts; by default, mclust uses the results from hierarchical clustering as the starting points for the EM algorithm.</p>
<div id="more-information-on-model-specifications" class="section level3">
<h3 class="hasAnchor">
<a href="#more-information-on-model-specifications" class="anchor"></a>5. More information on model specifications</h3>
<p>As mentioned earlier, there are a number of different models representing how–or whether–different parameters are estimated. Again, these are passed to the <code>model</code> argument to the <code><a href="../reference/estimate_profiles.html">estimate_profiles()</a></code> function (i.e. <code><a href="../reference/estimate_profiles.html">estimate_profiles(d, broad_interest, enjoyment, self_efficacy, n_profiles = 3, model = 2)</a></code>).</p>
<p>In general, the approach to choosing the model is similar to choosing the number of profiles, requiring deciding on the basis of evidence from multiple sources, including information criteria, statistical tests, and concerns of interpretability and parsimony. The article by <a href="http://www.sciencedirect.com/science/article/pii/S0361476X06000543">Pastor and colleagues (2007)</a> has helpful information on the model specifications. Here, the six models that are possible to specify in LPA are described in terms of how the variables used to create the profiles are estimated. Note that <em>p</em> represents different profiles and each parameterization is represented by a 4 x 4 covariance matrix and therefore would represent the parameterization for a four-profile solution. In all of the models, the means are estimated freely in the different profiles. Imagine that each row and column represents a different variable, i.e., the first row (and column) represents broad interest, the second enjoyment, the third self-efficacy, and the fourth another variable, i.e., future goals and plans.</p>
<div id="varying-means-equal-variances-and-covariances-fixed-to-0-model-1" class="section level4">
<h4 class="hasAnchor">
<a href="#varying-means-equal-variances-and-covariances-fixed-to-0-model-1" class="anchor"></a>1. Varying means, equal variances, and covariances fixed to 0 (model 1)</h4>
<p>In this model, which corresponds to the mclust model wit the name “EEI”, the variances are estimated to be equal across profiles, indicated by the absence of a p subscript for any of the diagonal elements of the matrix. The covariances are constrained to be zero, as indicated by the 0’s between every combination of the variables. Thus, this model is highly constrained but also parsimonious: the profiles are estimated in such a way that the variables’ variances are identical for each of the profiles, and the relationships between the variables are not estimated. In this way, less degrees of freedom are taken used to explain the observations that make up the data. However, estimating more parameters–as in the other models–may better explain the data, justifying the addition in complexity that their addition involves (and their reduction in degrees of freedom).</p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1 }^{ 2 } &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; { \sigma  }_{ 2 }^{ 2 } &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; { \sigma  }_{ 3 }^{ 2 } &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; { \sigma  }_{ 4 }^{ 2 } \end{matrix} \right] 
\]</span></p>
</div>
<div id="varying-means-equal-variances-and-equal-covariances-model-2" class="section level4">
<h4 class="hasAnchor">
<a href="#varying-means-equal-variances-and-equal-covariances-model-2" class="anchor"></a>2. Varying means, equal variances, and equal covariances (model 2)</h4>
<p>This model corresponds to the mclust model “EEE”. In this model, the variances are still constrained to be the same across the profiles, although now the covariances are estimated (but like the variances, are constrained to be the same across profiles). Thus, this model is the first to estimate the covariance (or correlations) of the variables used to create the profiles, thus adding more information that can be used to better understand the characteristics of the profiles (and, potentially, better explain the data).</p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1 }^{ 2 } &amp; { \sigma  }_{ 21 } &amp; { \sigma  }_{ 31 } &amp; { \sigma  }_{ 41 } \\ { \sigma  }_{ 12 } &amp; { \sigma  }_{ 2 }^{ 2 } &amp; { \sigma  }_{ 23 } &amp; { \sigma  }_{ 24 } \\ { \sigma  }_{ 13 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 3 }^{ 2 } &amp; { \sigma  }_{ 33 } \\ { \sigma  }_{ 14 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 4 }^{ 2 } \end{matrix} \right] 
\]</span></p>
</div>
<div id="varying-means-varying-variances-and-covariances-fixed-to-0-model-3" class="section level4">
<h4 class="hasAnchor">
<a href="#varying-means-varying-variances-and-covariances-fixed-to-0-model-3" class="anchor"></a>3. Varying means, varying variances, and covariances fixed to 0 (model 3)</h4>
<p>This model corresponds to the mclust model “VVI” and allows for the variances to be freely estimated across profiles. The covariances are constrained to zero. Thus, it is more flexible (and less parsimonious) than model 1, but in terms of the covariances, is more constrained than model 2.</p>
<p><span class="math display">\[ 
\left[ \begin{matrix} { \sigma  }_{ 1p }^{ 2 } &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; { \sigma  }_{ 2p }^{ 2 } &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; { \sigma  }_{ 3p }^{ 2 } &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; { \sigma  }_{ 4p }^{ 2 } \end{matrix} \right] 
\]</span></p>
</div>
<div id="varying-means-varying-variances-and-equal-covariances-model-4" class="section level4">
<h4 class="hasAnchor">
<a href="#varying-means-varying-variances-and-equal-covariances-model-4" class="anchor"></a>4. Varying means, varying variances, and equal covariances (model 4)</h4>
<p>This model, which specifies for the variances to be freely estimated across the profiles and for the covariances to be estimated to be equal across profiles, extends model 3. Unfortunately, this model cannot be specified with mclust, though it can be with MPlus; this model <em>can</em> be used with the functions to interface to MPlus described below.</p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1p }^{ 2 } &amp; { \sigma  }_{ 21 } &amp; { \sigma  }_{ 31 } &amp; { \sigma  }_{ 41 } \\ { \sigma  }_{ 12 } &amp; { \sigma  }_{ 2p }^{ 2 } &amp; { \sigma  }_{ 23 } &amp; { \sigma  }_{ 24 } \\ { \sigma  }_{ 13 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 3p }^{ 2 } &amp; { \sigma  }_{ 33 } \\ { \sigma  }_{ 14 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 12 } &amp; { \sigma  }_{ 4p }^{ 2 } \end{matrix} \right] 
\]</span></p>
</div>
<div id="varying-means-equal-variances-and-varying-covariances" class="section level4">
<h4 class="hasAnchor">
<a href="#varying-means-equal-variances-and-varying-covariances" class="anchor"></a>5. Varying means, equal variances, and varying covariances</h4>
<p>This model specifies the variances to be equal across the profiles, but allows the covariances to be freely estimated across the profiles. Like model 4, this model cannot be specified with mclust, though it can be with MPlus. Again, this model <em>can</em> be used with the functions to interface to MPlus described below.</p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1 }^{ 2 } &amp; { \sigma  }_{ 21p } &amp; { \sigma  }_{ 31p } &amp; { \sigma  }_{ 41p } \\ { \sigma  }_{ 12p } &amp; { \sigma  }_{ 2 }^{ 2 } &amp; { \sigma  }_{ 23p } &amp; { \sigma  }_{ 24p } \\ { \sigma  }_{ 13p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 3 }^{ 2 } &amp; { \sigma  }_{ 33p } \\ { \sigma  }_{ 14p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 4 }^{ 2 } \end{matrix} \right] \quad 
\]</span></p>
</div>
<div id="varying-means-varying-variances-and-varying-covariances" class="section level4">
<h4 class="hasAnchor">
<a href="#varying-means-varying-variances-and-varying-covariances" class="anchor"></a>6. Varying means, varying variances, and varying covariances</h4>
<p>This model corresponds to the mclust model “VVV”. It allows the variances and the covariances to be freely estimated across profiles. Thus, it is the most complex model, with the potential to allow for understanding many aspects of the variables that are used to estimate the profiles and how they are related. However, it is less parsimonious than all of the other models, and the added parameters should be considered in light of how preferred this model is relative to those with more simple specifications.</p>
<p><span class="math display">\[
\left[ \begin{matrix} { \sigma  }_{ 1p }^{ 2 } &amp; { \sigma  }_{ 21p } &amp; { \sigma  }_{ 31p } &amp; { \sigma  }_{ 41p } \\ { \sigma  }_{ 12p } &amp; { \sigma  }_{ 2p }^{ 2 } &amp; { \sigma  }_{ 23p } &amp; { \sigma  }_{ 24p } \\ { \sigma  }_{ 13p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 3p }^{ 2 } &amp; { \sigma  }_{ 33p } \\ { \sigma  }_{ 14p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 12p } &amp; { \sigma  }_{ 4p }^{ 2 } \end{matrix} \right] 
\]</span></p>
</div>
</div>
</div>
<div id="an-interface-to-mplus-in-development" class="section level2">
<h2 class="hasAnchor">
<a href="#an-interface-to-mplus-in-development" class="anchor"></a>6. An interface to MPlus (in-development)</h2>
<p><code>tidyLPA</code> has been bench marked to MPlus, at least for a simple data set (the <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">iris dataset</a>) and with three of the more common model specifications. You can find the results of that bench marking, which showed the results to be (nearly) identical, <a href="https://jrosen48.github.io/blog/comparing-mplus-and-mclust-output/">here</a>.</p>
<p>There is an in-development function to generate the model syntax (and prepare the data) and run the same models through the Mplus software. <strong>Note that you must have purchased and installed MPlus for these functions to work</strong>. Note that these functions are still in-development; the MPlus model syntax is dynamically generated for each model specified and then run through MPlus using the <a href="https://cran.r-project.org/package=MplusAutomation">MplusAutomation package</a>. These can be helpful for comparing the results between mclust and MPlus and for using output of the MPlus analyses in subsequent analyses, which can be difficult when using MPlus in a stand-alone matter.</p>
<p>Here is how to compare a number of models using MPlus (it works very similarly to <code><a href="../reference/compare_solutions.html">compare_solutions()</a></code>). Note that this and subsequent code using MPlus is not run in the vignette.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/compare_solutions_mplus.html">compare_solutions_mplus</a></span>(d, broad_interest, enjoyment, self_efficacy)</code></pre></div>
<p>Here is how to estimate profiles for a single solution. This function is very similar to <code><a href="../reference/estimate_profiles.html">estimate_profiles()</a></code>. Note that in addition to returning the profile assignment (<code>C</code>), the profile with the highest posterior probability, it also returns the posterior probabilities for the other profiles:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/estimate_profiles_mplus.html">estimate_profiles_mplus</a></span>(d, 
                              broad_interest, enjoyment, self_efficacy, 
                              <span class="dt">model =</span> <span class="dv">1</span>, 
                              <span class="dt">n_profiles =</span> <span class="dv">3</span>)</code></pre></div>
<p>There are many options to control the estimation (i.e., changing the number of starts); see the help for this function (<code><a href="../reference/estimate_profiles_mplus.html">?estimate_profiles_mplus()</a></code>) for information about the arguments that can be used.</p>
<p>We can plot the profile solution using <code><a href="../reference/plot_profiles_mplus.html">plot_profiles_mplus()</a></code>; the same arguments to center and scale the data can be used:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_profiles_mplus.html">plot_profiles_mplus</a></span>(m1, <span class="dt">to_center =</span> <span class="ot">TRUE</span>, <span class="dt">to_scale =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>These functions will be further developed in subsequent versions.</p>
</div>
<div id="other-features" class="section level2">
<h2 class="hasAnchor">
<a href="#other-features" class="anchor"></a>7. Other features</h2>
<p>There are a few other features of tidyLPA that will be described further in subsequent versions. Two that are available now that are briefly described are the use of a bootstrapped likelihood-ratio test and a prior. Both are presently only available for the mclust functions (i.e., it is not yet available through tidyLPA for the functions that use MPlus)</p>
<p><strong>Bootstrapped likelihood-ratio test (LRT)</strong></p>
<p>To determine the number of profiles for a specified model (i.e., models <code>1</code>-<code>4</code> described above, we can carry out a bootstrapped likelihood-ratio test. Note that the code is shown but run because it can take substantial time, even for a small data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/bootstrap_lrt.html">bootstrap_lrt</a></span>(d, broad_interest, enjoyment, self_efficacy, <span class="dt">model =</span> <span class="dv">3</span>)</code></pre></div>
<p><strong>Use of a prior</strong></p>
<p>Models fit with mclust can be estimated with a prior. This can be helpful for estimating models that might otherwise not be able to be estimated. Learn more in Fraley and Raftery (2007) <a href="https://link.springer.com/article/10.1007%2Fs00357-007-0004-5?LI=true">here</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/estimate_profiles.html">estimate_profiles</a></span>(d,
                  broad_interest, enjoyment, self_efficacy, 
                  <span class="dt">model =</span> <span class="dv">1</span>,
                  <span class="dt">n_profiles =</span> <span class="dv">4</span>,
                  <span class="dt">prior_control =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>8. Conclusion</h2>
<p>tidyLPA is actively being developed and this vignette will change as the package continues to be developed and used. The latest version of tidyLPA is available <a href="https://github.com/jrosen48/tidyLPA">here</a> on GitHub. More information is also available on the tidyLPA website <a href="https://jrosen48.github.io/tidyLPA/">here</a></p>
<p><strong>Notes</strong></p>
<p>This is related to <a href="https://github.com/jrosen48/prcr">prcr</a>, for use of two-step cluster analysis to carry out person-oriented analyses.</p>
<p>To contribute, file issues via GitHub <a href="https://github.com/jrosen48/tidyLPA/issues">here</a> or get in touch <a href="mailto:jrosen@msu.edu">via email</a> or <a href="https://twitter.com/jrosenberg6432">Twitter</a>.</p>
<p><strong>References</strong></p>
<p>Pastor, D. A., Barron, K. E., Miller, B. J., &amp; Davis, S. L. (2007). A latent profile analysis of college students’ achievement goal orientation. <em>Contemporary Educational Psychology, 32</em>(1), 8-47. (<a href="https://www.sciencedirect.com/science/article/pii/S0361476X06000543" class="uri">https://www.sciencedirect.com/science/article/pii/S0361476X06000543</a></p>
<p><strong>Helpful resources</strong></p>
<ul>
<li><p><a href="https://www.amazon.com/Handbook-Cluster-Analysis-Handbooks-Statistical/dp/1466551887/ref=sr_1_1?ie=UTF8&amp;qid=1517773186&amp;sr=8-1&amp;keywords=cluster+analysis+handbook">Hennig et al’s (2015)</a> handbook for an overview of mixture models, of which LPA is often considered an instance of.</p></li>
<li><p><a href="https://books.Google.com/books?hl=en&amp;lr=&amp;id=gPJQWKsgh3YC&amp;oi=fnd&amp;pg=PT12&amp;dq=collins+lanza&amp;ots=_0L9qnxxun&amp;sig=Vx9RhJgIv0zbttIgvYLxaUQwtFI#v=onepage&amp;q=collins%20lanza&amp;f=false">Collins and Lanza (2013)</a> for a book on the related approach (for use with dichotomous, rather than continuous variables used to create the profiles) Latent Class Analysis (LCA)</p></li>
</ul>
<p><strong>How to cite tidyLPA</strong></p>
<p>In the future, it is expected that parts of this vignette will be expanded into a peer-reviewed article. For now, to cite tidyLPA in presentations, publications, and other works, please use:</p>
<blockquote>
<p>Rosenberg, J. M., Schmidt, J. A., Beymer, P. N., &amp; Steingut, R. R. (2018). Interface to mclust to easily carry out Latent Profile Analysis [Statistical software for R]. <a href="https://github.com/jrosen48/tidyLPA" class="uri">https://github.com/jrosen48/tidyLPA</a></p>
</blockquote>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background-on-latent-profile-analysis-lpa">1. Background on Latent Profile Analysis (LPA)</a></li>
      <li><a href="#description-of-the-goals-of-tidylpa">2. Description of the goals of tidyLPA</a></li>
      <li><a href="#software-approach-to-carrying-out-lpa-interface-to-mclust-and-to-mplus">3. Software approach to carrying out LPA: Interface to mclust (and to MPlus)</a></li>
      <li><a href="#an-example-using-mclust">4. An example using mclust</a></li>
      <li><a href="#an-interface-to-mplus-in-development">6. An interface to MPlus (in-development)</a></li>
      <li><a href="#other-features">7. Other features</a></li>
      <li><a href="#conclusion">8. Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua M Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
